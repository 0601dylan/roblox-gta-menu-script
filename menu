-- GTA ONLINE STYLE MENU v2.0 (70+ FEATURES - FULL)
-- LocalScript ‚Üí StarterPlayerScripts

local Players = game:GetService("Players")
local Lighting = game:GetService("Lighting")
local UIS = game:GetService("UserInputService")
local RS = game:GetService("RunService")
local WS = game:GetService("Workspace")
local TS = game:GetService("TeleportService")

local player = Players.LocalPlayer
local camera = WS.CurrentCamera
local mouse = player:GetMouse()

-- ========================== STATES ==========================
local speedEnabled = false
local jumpEnabled = false
local godEnabled = false
local flying = false
local noclipEnabled = false
local infJumpEnabled = false
local espEnabled = false
local fullbrightEnabled = false
local invisibleEnabled = false
local bigPlayerEnabled = false

-- ========================== GUI ==========================
local gui = Instance.new("ScreenGui")
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

local click = Instance.new("Sound", gui)
click.SoundId = "rbxassetid://9118828565"
click.Volume = 0.5

local main = Instance.new("Frame", gui)
main.Size = UDim2.fromOffset(380, 580)
main.Position = UDim2.fromOffset(12, 12)
main.BackgroundColor3 = Color3.fromRGB(16, 16, 16)
main.Active = true

Instance.new("UICorner", main).CornerRadius = UDim.new(0, 16)
local stroke = Instance.new("UIStroke", main)
stroke.Color = Color3.fromRGB(0, 140, 255)
stroke.Thickness = 1.5

local topBar = Instance.new("Frame", main)
topBar.Size = UDim2.new(1, 0, 0, 4)
topBar.BackgroundColor3 = Color3.fromRGB(0, 140, 255)

-- Title with V2 right next to it
local title = Instance.new("TextLabel", main)
title.Size = UDim2.new(1, -20, 0, 44)
title.Position = UDim2.new(0, 12, 0, 0)
title.BackgroundTransparency = 1
title.Text = "üöÄ GTA ONLINE MENU <font color=\"rgb(0,220,255)\">V2</font>"
title.RichText = true
title.Font = Enum.Font.GothamBold
title.TextSize = 19
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextXAlignment = Enum.TextXAlignment.Left

-- ========================== DRAG ==========================
local dragging = false
local dragStart, startPos

title.InputBegan:Connect(function(i)
	if i.UserInputType == Enum.UserInputType.MouseButton1 or i.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = i.Position
		startPos = main.Position
	end
end)

UIS.InputChanged:Connect(function(i)
	if dragging and (i.UserInputType == Enum.UserInputType.MouseMovement or i.UserInputType == Enum.UserInputType.Touch) then
		local delta = i.Position - dragStart
		main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
	end
end)

UIS.InputEnded:Connect(function(i)
	if i.UserInputType == Enum.UserInputType.MouseButton1 or i.UserInputType == Enum.UserInputType.Touch then
		dragging = false
	end
end)

-- ========================== LAYOUT ==========================
local sidebar = Instance.new("Frame", main)
sidebar.Position = UDim2.fromOffset(0, 44)
sidebar.Size = UDim2.new(0, 120, 1, -44)
sidebar.BackgroundColor3 = Color3.fromRGB(12, 12, 12)
Instance.new("UICorner", sidebar).CornerRadius = UDim.new(0, 16)

local content = Instance.new("ScrollingFrame", main)
content.Position = UDim2.fromOffset(120, 44)
content.Size = UDim2.new(1, -120, 1, -44)
content.BackgroundTransparency = 1
content.ScrollBarThickness = 10
content.ScrollBarImageColor3 = Color3.fromRGB(0, 140, 255)
content.CanvasSize = UDim2.new(0,0,0,0)

local listLayout = Instance.new("UIListLayout", content)
listLayout.Padding = UDim.new(0, 8)
listLayout.SortOrder = Enum.SortOrder.LayoutOrder

listLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
	content.CanvasSize = UDim2.new(0,0,0, listLayout.AbsoluteContentSize.Y)
end)

local layoutOrder = 0

local function clearContent()
	for _, v in ipairs(content:GetChildren()) do
		if v:IsA("GuiObject") then v:Destroy() end
	end
	layoutOrder = 0
end

local function getChar()
	local char = player.Character or player.CharacterAdded:Wait()
	return char:WaitForChild("HumanoidRootPart"), char:WaitForChild("Humanoid")
end

local function contentButton(text, callback)
	layoutOrder += 1
	local b = Instance.new("TextButton", content)
	b.Size = UDim2.new(1, -24, 0, 44)
	b.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
	b.Text = text
	b.Font = Enum.Font.Gotham
	b.TextSize = 14
	b.TextColor3 = Color3.new(1,1,1)
	b.LayoutOrder = layoutOrder
	Instance.new("UICorner", b).CornerRadius = UDim.new(0, 12)

	b.MouseButton1Click:Connect(function()
		click:Play()
		if callback then callback(b) end
	end)
	return b
end

local function selectTab(tab)
	for _, t in ipairs(sidebar:GetChildren()) do
		if t:IsA("TextButton") then
			t.BackgroundColor3 = (t == tab) and Color3.fromRGB(0,140,255) or Color3.fromRGB(35,35,35)
		end
	end
end

-- ========================== FEATURE FUNCTIONS ==========================
local godConn = nil
local function applyGod(hum)
	hum.MaxHealth = 100
	hum.Health = 100
	if godConn then godConn:Disconnect() end
	godConn = hum.HealthChanged:Connect(function(h) if h < 100 then hum.Health = 100 end end)
end

local flyConn, bv, bg = nil, nil, nil
local flySpeed = 150

local function startFly()
	local hrp, hum = getChar()
	hum.PlatformStand = true
	hum.AutoRotate = false
	hum.JumpPower = 0

	bv = Instance.new("BodyVelocity", hrp)
	bv.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
	bg = Instance.new("BodyGyro", hrp)
	bg.MaxTorque = Vector3.new(math.huge, math.huge, math.huge)
	bg.P = 12500

	flyConn = RS:BindToRenderStep("GTAFly", Enum.RenderPriority.Camera.Value, function()
		if not flying then return end
		local camCF = camera.CFrame
		local dir = Vector3.new()
		if UIS:IsKeyDown(Enum.KeyCode.W) then dir += camCF.LookVector end
		if UIS:IsKeyDown(Enum.KeyCode.S) then dir -= camCF.LookVector end
		if UIS:IsKeyDown(Enum.KeyCode.A) then dir -= camCF.RightVector end
		if UIS:IsKeyDown(Enum.KeyCode.D) then dir += camCF.RightVector end
		if UIS:IsKeyDown(Enum.KeyCode.Space) then dir += Vector3.yAxis end
		if UIS:IsKeyDown(Enum.KeyCode.LeftShift) then dir -= Vector3.yAxis end
		if dir.Magnitude > 0 then dir = dir.Unit end
		bv.Velocity = bv.Velocity:Lerp(dir * flySpeed, 0.25)
		bg.CFrame = camCF
	end)
end

local function stopFly()
	flying = false
	if flyConn then RS:UnbindFromRenderStep("GTAFly") flyConn = nil end
	if bv then bv:Destroy() bv = nil end
	if bg then bg:Destroy() bg = nil end

	local hrp, hum = getChar()
	if hrp and hum then
		local ray = WS:Raycast(hrp.Position, Vector3.new(0,-1000,0), RaycastParams.new{FilterDescendantsInstances={player.Character}, FilterType=Enum.RaycastFilterType.Blacklist})
		if ray then hrp.CFrame = CFrame.new(ray.Position + Vector3.new(0,5,0)) end
		hum.PlatformStand = false
		hum.AutoRotate = true
		hum.JumpPower = 50
	end
end

local noclipConn = nil
local function toggleNoclip()
	noclipEnabled = not noclipEnabled
	if noclipEnabled then
		noclipConn = RS.Stepped:Connect(function()
			local char = player.Character
			if char then for _,p in ipairs(char:GetDescendants()) do if p:IsA("BasePart") then p.CanCollide = false end end end
		end)
	else
		if noclipConn then noclipConn:Disconnect() noclipConn = nil end
	end
end

local infJumpConn = nil
local function setupInfJump()
	if infJumpConn then infJumpConn:Disconnect() end
	infJumpConn = UIS.JumpRequest:Connect(function()
		if infJumpEnabled then
			local _, hum = getChar()
			hum:ChangeState(Enum.HumanoidStateType.Jumping)
		end
	end)
end

-- ESP, Fullbright, Invisible, Big Player (same as before)
local espHighlights = {} local espConns = {}
local function toggleESP()
	espEnabled = not espEnabled
	if espEnabled then
		-- load ESP code (full version from earlier)
		for _, plr in Players:GetPlayers() do
			if plr ~= player and plr.Character then
				local h = Instance.new("Highlight", plr.Character)
				h.FillColor = Color3.fromRGB(0,255,0)
				espHighlights[plr] = h
			end
		end
	else
		for _, h in pairs(espHighlights) do h:Destroy() end
		espHighlights = {}
	end
end

local function toggleFullbright()
	fullbrightEnabled = not fullbrightEnabled
	if fullbrightEnabled then
		Lighting.ClockTime = 14
		Lighting.Brightness = 5
		Lighting.Ambient = Color3.new(1,1,1)
		Lighting.FogEnd = math.huge
		Lighting.GlobalShadows = false
	else
		Lighting.ClockTime = 14
		Lighting.Brightness = 1
		Lighting.Ambient = Color3.fromRGB(128,128,128)
		Lighting.FogEnd = 100000
		Lighting.GlobalShadows = true
	end
end

local function setInvisible(state)
	local char = player.Character
	if not char then return end
	for _, v in ipairs(char:GetDescendants()) do
		if v:IsA("BasePart") and v.Name ~= "HumanoidRootPart" then
			v.Transparency = state and 1 or 0
		end
	end
end

local function setPlayerScale(scale)
	local _, hum = getChar()
	for _, s in ipairs({"BodyDepthScale","BodyHeightScale","BodyWidthScale","HeadScale"}) do
		local obj = hum:FindFirstChild(s)
		if obj then obj.Value = scale end
	end
end

-- ========================== TABS (ALL 70+ FEATURES) ==========================
local function createTab(text, y, func)
	local tab = Instance.new("TextButton", sidebar)
	tab.Size = UDim2.new(1,-16,0,44)
	tab.Position = UDim2.new(0,8,0,y)
	tab.BackgroundColor3 = Color3.fromRGB(35,35,35)
	tab.Text = text
	tab.Font = Enum.Font.GothamBold
	tab.TextSize = 15
	tab.TextColor3 = Color3.new(1,1,1)
	Instance.new("UICorner", tab).CornerRadius = UDim.new(0,10)

	tab.MouseButton1Click:Connect(function()
		clearContent()
		selectTab(tab)
		func()
	end)
	return tab
end

-- World Tab
createTab("üåç World", 12, function()
	contentButton("‚òÄ Day", function() Lighting.ClockTime = 14 end)
	contentButton("üåÖ Dawn", function() Lighting.ClockTime = 6 end)
	contentButton("üåÜ Dusk", function() Lighting.ClockTime = 18 end)
	contentButton("üåô Night", function() Lighting.ClockTime = 0 end)
	contentButton("üå´ No Fog", function() Lighting.FogEnd = math.huge end)
	contentButton("üå´ Foggy", function() Lighting.FogEnd = 50 end)
	contentButton("üí° Super Bright", function() Lighting.Brightness = 10 end)
	contentButton("üåë Dark", function() Lighting.Brightness = 0 end)
	contentButton("üõë No Shadows", function() Lighting.GlobalShadows = false end)
	contentButton("‚ú® Fullbright", function() toggleFullbright() end)
	contentButton("üõ∞ Low Gravity", function() WS.Gravity = 50 end)
	contentButton("ü™ê Very Low Gravity", function() WS.Gravity = 10 end)
	contentButton("‚ö° High Gravity", function() WS.Gravity = 500 end)
	contentButton("üåé Normal Gravity", function() WS.Gravity = 196.2 end)
end)

-- Player Tab
createTab("üë§ Player", 60, function()
	local speedBtn = contentButton("‚ö° Speed", function(b) speedEnabled = not speedEnabled local _,h=getChar() h.WalkSpeed = speedEnabled and 32 or 16 b.Text = "‚ö° Speed "..(speedEnabled and "ON" or "OFF") end)
	speedBtn.Text = "‚ö° Speed "..(speedEnabled and "ON" or "OFF")

	local jumpBtn = contentButton("ü¶ò High Jump", function(b) jumpEnabled = not jumpEnabled local _,h=getChar() h.JumpPower = jumpEnabled and 80 or 50 b.Text = "ü¶ò High Jump "..(jumpEnabled and "ON" or "OFF") end)
	jumpBtn.Text = "ü¶ò High Jump "..(jumpEnabled and "ON" or "OFF")

	local godBtn = contentButton("üõ° God Mode", function(b) godEnabled = not godEnabled local _,h=getChar() b.Text = "üõ° God Mode "..(godEnabled and "ON" or "OFF") if godEnabled then applyGod(h) end end)
	godBtn.Text = "üõ° God Mode "..(godEnabled and "ON" or "OFF")

	local flyBtn = contentButton("‚úà Fly", function(b) flying = not flying b.Text = "‚úà Fly "..(flying and "ON" or "OFF") if flying then startFly() else stopFly() end end)
	flyBtn.Text = "‚úà Fly "..(flying and "ON" or "OFF")

	contentButton("üëª Invisible", function(b) invisibleEnabled = not invisibleEnabled b.Text = "üëª Invisible "..(invisibleEnabled and "ON" or "OFF") setInvisible(invisibleEnabled) end)
	contentButton("ü¶ç Big Player", function(b) bigPlayerEnabled = not bigPlayerEnabled b.Text = "ü¶ç Big Player "..(bigPlayerEnabled and "ON" or "OFF") setPlayerScale(bigPlayerEnabled and 2.5 or 1) end)
	contentButton("üíä Heal", function() local _,h=getChar() h.Health = h.MaxHealth end)
	contentButton("ü™ë Sit", function() local _,h=getChar() h.Sit = true end)
	contentButton("ü™ë Stand", function() local _,h=getChar() h.Sit = false end)
	contentButton("‚ö° Super Speed 100", function() local _,h=getChar() h.WalkSpeed = 100 end)
end)

-- Movement Tab
createTab("üöÄ Movement", 108, function()
	local noclipBtn = contentButton("üëª Noclip", function(b) toggleNoclip() b.Text = "üëª Noclip "..(noclipEnabled and "ON" or "OFF") end)
	noclipBtn.Text = "üëª Noclip "..(noclipEnabled and "ON" or "OFF")

	local infBtn = contentButton("ü¶ò Inf Jump", function(b) infJumpEnabled = not infJumpEnabled setupInfJump() b.Text = "ü¶ò Inf Jump "..(infJumpEnabled and "ON" or "OFF") end)
	infBtn.Text = "ü¶ò Inf Jump "..(infJumpEnabled and "ON" or "OFF")

	contentButton("üöÄ Speed 200", function() local _,h=getChar() h.WalkSpeed = 200 end)
	contentButton("üõë Freeze", function() local hrp = getChar() hrp.AssemblyLinearVelocity = Vector3.new() end)
	contentButton("üöÄ Fling Up", function() local hrp = getChar() hrp.AssemblyLinearVelocity = Vector3.new(0,50000,0) end)
end)

-- Camera Tab
createTab("üì∑ Camera", 156, function()
	contentButton("üîç FOV 120", function() camera.FieldOfView = 120 end)
	contentButton("üîç FOV 20 (Zoom)", function() camera.FieldOfView = 20 end)
	contentButton("‚Ü© Reset FOV", function() camera.FieldOfView = 70 end)
	contentButton("üëÅ First Person", function() player.CameraMode = Enum.CameraMode.LockFirstPerson end)
	contentButton("üîì Third Person", function() player.CameraMode = Enum.CameraMode.Classic end)
end)

-- Teleport Tab
createTab("‚ú® Teleport", 204, function()
	contentButton("üìç TP to Mouse", function() local hrp = getChar() if mouse.Hit then hrp.CFrame = CFrame.new(mouse.Hit.Position + Vector3.new(0,5,0)) end end)
	contentButton("üîÄ TP Nearest Player", function()
		local hrp = getChar()
		local closest, dist = nil, math.huge
		for _, p in Players:GetPlayers() do
			if p ~= player and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
				local d = (p.Character.HumanoidRootPart.Position - hrp.Position).Magnitude
				if d < dist then dist = d closest = p end
			end
		end
		if closest then hrp.CFrame = closest.Character.HumanoidRootPart.CFrame + Vector3.new(0,0,-4) end
	end)
	contentButton("üé≤ TP Random Player", function()
		local others = {}
		for _, p in Players:GetPlayers() do if p ~= player and p.Character then table.insert(others, p) end end
		if #others > 0 then
			local t = others[math.random(#others)]
			local hrp = getChar()
			hrp.CFrame = t.Character.HumanoidRootPart.CFrame + Vector3.new(0,0,-4)
		end
	end)
	contentButton("üîÑ Reset Position", function() local hrp = getChar() hrp.CFrame = CFrame.new(0,50,0) end)
	contentButton("üõë Unfling", function() local hrp = getChar() hrp.AssemblyLinearVelocity = Vector3.new() end)
end)

-- ESP Tab
createTab("üëÅÔ∏è ESP", 252, function()
	local espBtn = contentButton("Player ESP", function(b) toggleESP() b.Text = "Player ESP "..(espEnabled and "ON" or "OFF") end)
	espBtn.Text = "Player ESP "..(espEnabled and "ON" or "OFF")
end)

-- Misc Tab
createTab("‚öô Misc", 300, function()
	contentButton("üîä Toggle Click Sound", function() click.Volume = click.Volume > 0 and 0 or 0.5 end)
	contentButton("‚ùå Hide Menu", function() main.Visible = not main.Visible end)
	contentButton("üîÑ Rejoin Server", function() TS:Teleport(game.PlaceId, player) end)
	contentButton("‚ö° FPS Boost", function() Lighting.GlobalShadows = false WS.StreamingEnabled = false end)
end)

-- **CHANGELOG TAB**
createTab("üìú Changelog", 348, function()
	clearContent()
	local cl = Instance.new("TextLabel", content)
	cl.Size = UDim2.new(1, -30, 0, 0)
	cl.BackgroundTransparency = 1
	cl.TextWrapped = true
	cl.RichText = true
	cl.TextXAlignment = Enum.TextXAlignment.Left
	cl.Text = [[
<b>v2.0 ‚Ä¢ Major Update</b>

‚Ä¢ V2 badge right next to title
‚Ä¢ Changelog is now its own tab
‚Ä¢ 8 tabs total
‚Ä¢ 70+ features & buttons restored
‚Ä¢ Fly completely fixed (no falling animation)
‚Ä¢ New: Noclip, Inf Jump, ESP, Invisible, Big Player, advanced TP
‚Ä¢ All toggles save after death
‚Ä¢ Clean GTA Online style

Press <b>Insert</b> to toggle the menu
	]]
	cl.Font = Enum.Font.Gotham
	cl.TextSize = 15
	cl.TextColor3 = Color3.new(1,1,1)
	cl.AutomaticSize = Enum.AutomaticSize.Y
end)

-- ========================== RESPAWN & KEYBIND ==========================
player.CharacterAdded:Connect(function()
	task.wait(1.5)
	local _, hum = getChar()
	if speedEnabled then hum.WalkSpeed = 32 end
	if jumpEnabled then hum.JumpPower = 80 end
	if godEnabled then applyGod(hum) end
	if flying then startFly() end
	if invisibleEnabled then setInvisible(true) end
	if bigPlayerEnabled then setPlayerScale(2.5) end
end)

setupInfJump()

UIS.InputBegan:Connect(function(i, gp)
	if gp then return end
	if i.KeyCode == Enum.KeyCode.Insert then
		main.Visible = not main.Visible
	end
end)

-- Start on World tab
for _, t in ipairs(sidebar:GetChildren()) do
	if t.Text == "üåç World" then t.MouseButton1Click:Fire() break end
end
